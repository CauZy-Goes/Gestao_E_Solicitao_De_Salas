<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Gestão De Salas</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <style>
        /*headder*/
        .header {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 90px;
        }
    </style>
</h:head>

<h:body>

    <header id="header" class="header">

        <h1>DashBoard Do #{cargoMB.getNomeCargoById(usuarioMB.usuarioLogado.idCargo)}</h1>
        <h:panelGroup id="userInfo">
            <h1>Bem-vindo, #{usuarioMB.usuarioLogado.nomeUsuario}!</h1>
        </h:panelGroup>

        <p:commandButton value="Minhas Solicitações"
                         rendered="#{usuarioMB.usuarioLogado.idCargo == 2}"/>
        <h:form>
            <p:commandButton value="Salas"
                             rendered="#{usuarioMB.usuarioLogado.idCargo == 1}"
                             action="/pages/gestor/salas.xhtml?faces-redirect=true" />

            <p:commandButton value="Dashboard"
                             rendered="#{usuarioMB.usuarioLogado.idCargo == 1}"
                             action="/pages/gestor/dashboardGestor.xhtml?faces-redirect=true" />
        </h:form>

        <h:form id="form_update">
            <!-- Botão que abre o modal -->
            <p:commandButton value="Perfil" icon="pi pi-plus" actionListener="#{usuarioMB.prepararEdicao()}"
                             oncomplete="PF('popupUpdate').show()" update="popupUpdate @form" process="@this"/>

            <!-- Dialog que serve como popup -->
            <p:dialog id="popupUpdate" widgetVar="popupUpdate" header="Update Perfil"
                      modal="true" resizable="false" width="400">

                <h:panelGrid columns="2" cellpadding="5">

                    <p:outputLabel for="nome" value="Nome:" />
                    <p:inputText id="nome" value="#{usuarioMB.usuarioDTO.nomeUsuario}" required="true"/>

                    <p:outputLabel for="email" value="E-mail:" />
                    <p:inputText id="email" value="#{usuarioMB.usuarioDTO.email}" required="true"/>

                    <p:outputLabel for="senha" value="Senha :"/>
                    <p:inputText id="senha" value="#{usuarioMB.usuarioDTO.senha}"  required="true"/>


                    <p:messages autoUpdate="true" id="message_update"/>
                    <p:commandButton value="Salvar" icon="pi pi-check" actionListener="#{usuarioMB.updateUser}"
                                     oncomplete="PF('popupUpdate').show()" update="userInfo message_update"/>
                </h:panelGrid>
            </p:dialog>

            <p:commandButton value="Logout" action="#{usuarioMB.logout()}" update="@form" process="@this"/>
        </h:form>
    </header>

    <ui:insert name="corpo"/>

</h:body>

</html>